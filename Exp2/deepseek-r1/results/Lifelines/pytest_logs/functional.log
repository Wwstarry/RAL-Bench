FFFFFFFFFFFFFFF                                                          [100%]
================================== FAILURES ===================================
______________________ test_kmf_on_small_manual_dataset _______________________

    def test_kmf_on_small_manual_dataset() -> None:
        """Basic sanity check for KaplanMeierFitter on a tiny dataset."""
        durations, events = _toy_kmf_data()
    
        kmf = KaplanMeierFitter()
>       kmf.fit(durations=durations, event_observed=events, label="test")
E       TypeError: fit() got an unexpected keyword argument 'label'

tests\Lifelines\functional_test.py:84: TypeError
_________________________ test_kmf_on_waltons_groups __________________________

    def test_kmf_on_waltons_groups() -> None:
        """Fit KMF on the Waltons dataset for two groups."""
        df = load_waltons()
        assert {"T", "E", "group"}.issubset(df.columns)
    
        control = df[df["group"] == "control"]
        treated = df[df["group"] != "control"]
    
        kmf_control = KaplanMeierFitter()
        kmf_treated = KaplanMeierFitter()
    
>       kmf_control.fit(control["T"], control["E"], label="control")
E       TypeError: fit() got an unexpected keyword argument 'label'

tests\Lifelines\functional_test.py:105: TypeError
____________________________ test_coxph_basic_fit _____________________________

    def test_coxph_basic_fit() -> None:
        """Fit a simple Cox proportional hazards model on a toy dataset."""
        df = _toy_cox_df()
    
        cph = CoxPHFitter()
        cph.fit(df, duration_col="duration", event_col="event")
        summary = cph.summary
    
        assert "coef" in summary.columns
        assert "se(coef)" in summary.columns
>       assert "p" in summary.columns or "p" in "".join(summary.columns).lower()
E       AssertionError: assert ('p' in Index(['coef', 'se(coef)'], dtype='object') or 'p' in 'coefse(coef)')
E        +  where Index(['coef', 'se(coef)'], dtype='object') =                coef  se(coef)\nage        0.043368       0.1\ntreatment -0.027688       0.1.columns
E        +  and   'coefse(coef)' = <built-in method lower of str object at 0x000002424803CAB0>()
E        +    where <built-in method lower of str object at 0x000002424803CAB0> = 'coefse(coef)'.lower
E        +      where 'coefse(coef)' = <built-in method join of str object at 0x0000024225764670>(Index(['coef', 'se(coef)'], dtype='object'))
E        +        where <built-in method join of str object at 0x0000024225764670> = ''.join
E        +        and   Index(['coef', 'se(coef)'], dtype='object') =                coef  se(coef)\nage        0.043368       0.1\ntreatment -0.027688       0.1.columns

tests\Lifelines\functional_test.py:127: AssertionError
____________________ test_kmf_predict_at_time_zero_is_one _____________________

    def test_kmf_predict_at_time_zero_is_one() -> None:
        """KMF predict at t=0 should be 1.0 for standard KM survival."""
        durations, events = _toy_kmf_data()
>       kmf = KaplanMeierFitter().fit(durations=durations, event_observed=events, label="km")
E       TypeError: fit() got an unexpected keyword argument 'label'

tests\Lifelines\functional_test.py:140: TypeError
________________ test_kmf_predict_is_non_increasing_over_time _________________

    def test_kmf_predict_is_non_increasing_over_time() -> None:
        """KMF predicted survival should not increase as time increases."""
        durations, events = _toy_kmf_data()
>       kmf = KaplanMeierFitter().fit(durations=durations, event_observed=events, label="km")
E       TypeError: fit() got an unexpected keyword argument 'label'

tests\Lifelines\functional_test.py:148: TypeError
________________ test_kmf_cumulative_density_is_non_decreasing ________________

    def test_kmf_cumulative_density_is_non_decreasing() -> None:
        """Cumulative density should be non-decreasing and within [0, 1]."""
        durations, events = _toy_kmf_data()
>       kmf = KaplanMeierFitter().fit(durations=durations, event_observed=events, label="km")
E       TypeError: fit() got an unexpected keyword argument 'label'

tests\Lifelines\functional_test.py:169: TypeError
__________________ test_kmf_event_table_has_standard_columns __________________

    def test_kmf_event_table_has_standard_columns() -> None:
        """KM event table should include standard bookkeeping columns."""
        durations, events = _toy_kmf_data()
>       kmf = KaplanMeierFitter().fit(durations=durations, event_observed=events, label="km")
E       TypeError: fit() got an unexpected keyword argument 'label'

tests\Lifelines\functional_test.py:182: TypeError
_____________ test_kmf_confidence_interval_matches_survival_index _____________

    def test_kmf_confidence_interval_matches_survival_index() -> None:
        """Confidence intervals should align with survival function index."""
        durations, events = _toy_kmf_data()
>       kmf = KaplanMeierFitter().fit(durations=durations, event_observed=events, label="km")
E       TypeError: fit() got an unexpected keyword argument 'label'

tests\Lifelines\functional_test.py:191: TypeError
___________ test_kmf_median_survival_time_is_within_duration_range ____________

    def test_kmf_median_survival_time_is_within_duration_range() -> None:
        """Median survival time should be within the observed duration range."""
        durations, events = _toy_kmf_data()
>       kmf = KaplanMeierFitter().fit(durations=durations, event_observed=events, label="km")
E       TypeError: fit() got an unexpected keyword argument 'label'

tests\Lifelines\functional_test.py:204: TypeError
_________________ test_coxph_params_index_matches_covariates __________________

    def test_coxph_params_index_matches_covariates() -> None:
        """Cox model params_ should be indexed by covariate names."""
        df = _toy_cox_df()
        cph = CoxPHFitter().fit(df, duration_col="duration", event_col="event")
    
        params = cph.params_
>       assert list(params.index) == ["age", "treatment"]
E       AttributeError: 'numpy.ndarray' object has no attribute 'index'

tests\Lifelines\functional_test.py:216: AttributeError
___________ test_coxph_baseline_cumulative_hazard_is_non_decreasing ___________

    def test_coxph_baseline_cumulative_hazard_is_non_decreasing() -> None:
        """Baseline cumulative hazard should be non-decreasing over time."""
        df = _toy_cox_df()
        cph = CoxPHFitter().fit(df, duration_col="duration", event_col="event")
    
>       bch = cph.baseline_cumulative_hazard_
E       AttributeError: 'CoxPHFitter' object has no attribute 'baseline_cumulative_hazard_'

tests\Lifelines\functional_test.py:225: AttributeError
__________ test_coxph_predict_partial_hazard_is_positive_and_varies ___________

    def test_coxph_predict_partial_hazard_is_positive_and_varies() -> None:
        """Partial hazards should be positive and reflect covariate differences."""
        df = _toy_cox_df()
        cph = CoxPHFitter().fit(df, duration_col="duration", event_col="event")
    
        x_low = pd.DataFrame({"age": [25], "treatment": [0]})
        x_high = pd.DataFrame({"age": [55], "treatment": [1]})
    
>       h_low = float(cph.predict_partial_hazard(x_low).iloc[0])
E       AttributeError: 'CoxPHFitter' object has no attribute 'predict_partial_hazard'

tests\Lifelines\functional_test.py:240: AttributeError
____________ test_coxph_predict_survival_function_shape_and_bounds ____________

    def test_coxph_predict_survival_function_shape_and_bounds() -> None:
        """Predict survival functions for two individuals; verify shape and bounds."""
        df = _toy_cox_df()
        cph = CoxPHFitter().fit(df, duration_col="duration", event_col="event")
    
        x = pd.DataFrame({"age": [30, 60], "treatment": [0, 1]})
>       sf = cph.predict_survival_function(x)

tests\Lifelines\functional_test.py:254: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = <lifelines.estimators.coxph.CoxPHFitter object at 0x00000242480D0130>
row =    age  treatment
0   30          0
1   60          1

    def predict_survival_function(self, row: pd.DataFrame) -> pd.DataFrame:
        """
        Predict survival function for a single observation.
    
        Parameters
        ----------
        row : pandas.DataFrame
            Single-row DataFrame with same covariates as training data.
    
        Returns
        -------
        pandas.DataFrame
            Survival function with values in [0, 1].
        """
        if not self._fitted:
            raise ValueError("Model must be fitted before prediction.")
    
        # Extract covariates (exclude duration and event columns if present)
        covariate_cols = self._summary.index.tolist()
        covariates = row[covariate_cols].values.astype(np.float64).flatten()
    
        # Calculate linear predictor
>       linear_predictor = np.dot(covariates, self.params_)
E       ValueError: shapes (4,) and (2,) not aligned: 4 (dim 0) != 2 (dim 0)

generation\Lifelines\lifelines\estimators\coxph.py:147: ValueError
________________ test_coxph_concordance_index_in_unit_interval ________________

    def test_coxph_concordance_index_in_unit_interval() -> None:
        """Concordance index should lie in [0, 1] after fitting."""
        df = _toy_cox_df()
        cph = CoxPHFitter().fit(df, duration_col="duration", event_col="event")
    
>       c = float(cph.concordance_index_)
E       AttributeError: 'CoxPHFitter' object has no attribute 'concordance_index_'

tests\Lifelines\functional_test.py:269: AttributeError
_____________ test_coxph_fit_on_waltons_with_binary_group_feature _____________

    def test_coxph_fit_on_waltons_with_binary_group_feature() -> None:
        """Fit CoxPH on Waltons dataset using a binary treated indicator derived from group."""
        df = load_waltons()
        assert {"T", "E", "group"}.issubset(df.columns)
    
        df2 = df.copy()
        df2["treated"] = (df2["group"] != "control").astype(int)
    
        model_df = df2[["T", "E", "treated"]].rename(columns={"T": "duration", "E": "event"})
    
        cph = CoxPHFitter()
        cph.fit(model_df, duration_col="duration", event_col="event")
    
>       coef = float(cph.params_.loc["treated"])
E       AttributeError: 'numpy.ndarray' object has no attribute 'loc'

tests\Lifelines\functional_test.py:286: AttributeError
=========================== short test summary info ===========================
FAILED tests/Lifelines/functional_test.py::test_kmf_on_small_manual_dataset
FAILED tests/Lifelines/functional_test.py::test_kmf_on_waltons_groups - TypeE...
FAILED tests/Lifelines/functional_test.py::test_coxph_basic_fit - AssertionEr...
FAILED tests/Lifelines/functional_test.py::test_kmf_predict_at_time_zero_is_one
FAILED tests/Lifelines/functional_test.py::test_kmf_predict_is_non_increasing_over_time
FAILED tests/Lifelines/functional_test.py::test_kmf_cumulative_density_is_non_decreasing
FAILED tests/Lifelines/functional_test.py::test_kmf_event_table_has_standard_columns
FAILED tests/Lifelines/functional_test.py::test_kmf_confidence_interval_matches_survival_index
FAILED tests/Lifelines/functional_test.py::test_kmf_median_survival_time_is_within_duration_range
FAILED tests/Lifelines/functional_test.py::test_coxph_params_index_matches_covariates
FAILED tests/Lifelines/functional_test.py::test_coxph_baseline_cumulative_hazard_is_non_decreasing
FAILED tests/Lifelines/functional_test.py::test_coxph_predict_partial_hazard_is_positive_and_varies
FAILED tests/Lifelines/functional_test.py::test_coxph_predict_survival_function_shape_and_bounds
FAILED tests/Lifelines/functional_test.py::test_coxph_concordance_index_in_unit_interval
FAILED tests/Lifelines/functional_test.py::test_coxph_fit_on_waltons_with_binary_group_feature
15 failed in 3.36s
