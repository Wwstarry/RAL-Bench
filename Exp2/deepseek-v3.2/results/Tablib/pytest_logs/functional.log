FF..F...F..                                                              [100%]
================================== FAILURES ===================================
______________ test_dataset_export_import_csv_and_json_roundtrip ______________

    def test_dataset_export_import_csv_and_json_roundtrip() -> None:
        """Exercise core CSV/JSON export and import roundtrips on Dataset."""
        data = _build_sample_dataset()
    
        # CSV roundtrip via export + .csv setter.
        csv_text = data.export("csv")
        assert isinstance(csv_text, str)
    
        loaded_csv = tablib.Dataset()
        loaded_csv.csv = csv_text
    
        assert loaded_csv.headers == data.headers
>       assert loaded_csv.height == data.height
E       assert 4 == 3
E        +  where 4 = <Dataset height=4 width=3>.height
E        +  and   3 = <Dataset height=3 width=3>.height

tests\Tablib\functional_test.py:134: AssertionError
__________________ test_dataset_export_import_tsv_roundtrip ___________________

    def test_dataset_export_import_tsv_roundtrip() -> None:
        """TSV export/import should preserve shape and values (type-coercion tolerant)."""
        if not _format_supported("tsv"):
            pytest.skip("tsv format not available in this tablib build")
    
        data = _build_sample_dataset()
>       tsv_text = data.export("tsv")

tests\Tablib\functional_test.py:163: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = <Dataset height=3 width=3>, fmt = 'tsv'

    def export(self, fmt: str) -> str:
        """Export dataset to specified format."""
        if fmt == 'csv':
            return self.csv
        elif fmt == 'json':
            return self.json
        else:
>           raise ValueError(f"Unsupported format: {fmt}")
E           ValueError: Unsupported format: tsv

generation\Tablib\tablib\core.py:152: ValueError
__________________ test_dataset_insert_and_pop_row_semantics __________________

    def test_dataset_insert_and_pop_row_semantics() -> None:
        """Dataset should support inserting and popping rows (list-like usage)."""
        data = tablib.Dataset(headers=("id", "name"))
        data.append((1, "a"))
        data.append((3, "c"))
    
        # Insert a missing middle row.
>       data.insert(1, (2, "b"))
E       AttributeError: 'Dataset' object has no attribute 'insert'

tests\Tablib\functional_test.py:233: AttributeError
______________ test_dataset_export_html_contains_table_structure ______________

    def test_dataset_export_html_contains_table_structure() -> None:
        """HTML export (if available) should include a table-like structure and headers."""
        if not _format_supported("html"):
            pytest.skip("html format not available in this tablib build")
    
        data = _build_sample_dataset()
>       html = data.export("html")

tests\Tablib\functional_test.py:292: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = <Dataset height=3 width=3>, fmt = 'html'

    def export(self, fmt: str) -> str:
        """Export dataset to specified format."""
        if fmt == 'csv':
            return self.csv
        elif fmt == 'json':
            return self.json
        else:
>           raise ValueError(f"Unsupported format: {fmt}")
E           ValueError: Unsupported format: html

generation\Tablib\tablib\core.py:152: ValueError
=========================== short test summary info ===========================
FAILED tests/Tablib/functional_test.py::test_dataset_export_import_csv_and_json_roundtrip
FAILED tests/Tablib/functional_test.py::test_dataset_export_import_tsv_roundtrip
FAILED tests/Tablib/functional_test.py::test_dataset_insert_and_pop_row_semantics
FAILED tests/Tablib/functional_test.py::test_dataset_export_html_contains_table_structure
4 failed, 7 passed in 0.53s
