FFFFFFFFFFF                                                              [100%]
================================== FAILURES ===================================
______________________ test_insert_and_query_basic_rows _______________________

    def test_insert_and_query_basic_rows() -> None:
        db = create_in_memory_db()
        table = db["users"]
    
>       table.insert({"name": "Alice", "age": 30, "country": "DE"})

tests\Dataset\functional_test.py:142: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
repositories\Dataset\dataset\table.py:118: in insert
    row = self._sync_columns(row, ensure, types=types)
repositories\Dataset\dataset\table.py:366: in _sync_columns
    ensure = self._check_ensure(ensure)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = <[AttributeError("'Database' object has no attribute 'lock'") raised in repr()] Table object at 0x167c586a5b0>
ensure = None

    def _check_ensure(self, ensure):
        if ensure is None:
>           return self.db.ensure_schema
E           AttributeError: 'Database' object has no attribute 'ensure_schema'

repositories\Dataset\dataset\table.py:386: AttributeError
_______________________ test_update_upsert_and_indexes ________________________

    def test_update_upsert_and_indexes() -> None:
        db = create_in_memory_db()
        table = db["accounts"]
    
        rows = [
            {"account_id": 1, "owner": "Alice", "balance": 100.0, "currency": "EUR"},
            {"account_id": 2, "owner": "Bob", "balance": 250.0, "currency": "USD"},
        ]
>       table.insert_many(rows)

tests\Dataset\functional_test.py:175: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
repositories\Dataset\dataset\table.py:172: in insert_many
    self._sync_columns(sync_row, ensure, types=types)
repositories\Dataset\dataset\table.py:366: in _sync_columns
    ensure = self._check_ensure(ensure)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = <[AttributeError("'Database' object has no attribute 'lock'") raised in repr()] Table object at 0x167c58e7c70>
ensure = None

    def _check_ensure(self, ensure):
        if ensure is None:
>           return self.db.ensure_schema
E           AttributeError: 'Database' object has no attribute 'ensure_schema'

repositories\Dataset\dataset\table.py:386: AttributeError
____________________ test_transactions_commit_and_rollback ____________________

tmp_path = WindowsPath('C:/Users/86152/AppData/Local/Temp/pytest-of-86152/pytest-433/test_transactions_commit_and_r0')

    def test_transactions_commit_and_rollback(tmp_path: Path) -> None:
        db_path = tmp_path / "tx_sample.db"
        db_url = "sqlite:///%s" % str(db_path)
        db = dataset.connect(db_url)
        table = db["events"]
    
        db.begin()
>       table.insert({"name": "committed", "category": "ok"})

tests\Dataset\functional_test.py:203: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
repositories\Dataset\dataset\table.py:118: in insert
    row = self._sync_columns(row, ensure, types=types)
repositories\Dataset\dataset\table.py:366: in _sync_columns
    ensure = self._check_ensure(ensure)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = <[AttributeError("'Database' object has no attribute 'lock'") raised in repr()] Table object at 0x167c58d4ca0>
ensure = None

    def _check_ensure(self, ensure):
        if ensure is None:
>           return self.db.ensure_schema
E           AttributeError: 'Database' object has no attribute 'ensure_schema'

repositories\Dataset\dataset\table.py:386: AttributeError
___________________ test_insert_many_returns_ids_and_count ____________________

    def test_insert_many_returns_ids_and_count() -> None:
        db = create_in_memory_db()
        table = db["items"]
    
        rows = [{"name": "A"}, {"name": "B"}, {"name": "C"}]
>       ret = table.insert_many(rows)

tests\Dataset\functional_test.py:223: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
repositories\Dataset\dataset\table.py:172: in insert_many
    self._sync_columns(sync_row, ensure, types=types)
repositories\Dataset\dataset\table.py:366: in _sync_columns
    ensure = self._check_ensure(ensure)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = <[AttributeError("'Database' object has no attribute 'lock'") raised in repr()] Table object at 0x167c58ca340>
ensure = None

    def _check_ensure(self, ensure):
        if ensure is None:
>           return self.db.ensure_schema
E           AttributeError: 'Database' object has no attribute 'ensure_schema'

repositories\Dataset\dataset\table.py:386: AttributeError
_____________________ test_find_one_missing_returns_none ______________________

    def test_find_one_missing_returns_none() -> None:
        db = create_in_memory_db()
        table = db["t"]
>       table.insert({"name": "only"})

tests\Dataset\functional_test.py:237: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
repositories\Dataset\dataset\table.py:118: in insert
    row = self._sync_columns(row, ensure, types=types)
repositories\Dataset\dataset\table.py:366: in _sync_columns
    ensure = self._check_ensure(ensure)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = <[AttributeError("'Database' object has no attribute 'lock'") raised in repr()] Table object at 0x167c58c4700>
ensure = None

    def _check_ensure(self, ensure):
        if ensure is None:
>           return self.db.ensure_schema
E           AttributeError: 'Database' object has no attribute 'ensure_schema'

repositories\Dataset\dataset\table.py:386: AttributeError
_______________________ test_find_order_by_limit_offset _______________________

    def test_find_order_by_limit_offset() -> None:
        db = create_in_memory_db()
        table = db["nums"]
        for i in range(10):
>           table.insert({"n": i})

tests\Dataset\functional_test.py:246: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
repositories\Dataset\dataset\table.py:118: in insert
    row = self._sync_columns(row, ensure, types=types)
repositories\Dataset\dataset\table.py:366: in _sync_columns
    ensure = self._check_ensure(ensure)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = <[AttributeError("'Database' object has no attribute 'lock'") raised in repr()] Table object at 0x167c58c5ac0>
ensure = None

    def _check_ensure(self, ensure):
        if ensure is None:
>           return self.db.ensure_schema
E           AttributeError: 'Database' object has no attribute 'ensure_schema'

repositories\Dataset\dataset\table.py:386: AttributeError
___________________ test_table_all_iteration_and_row_shape ____________________

    def test_table_all_iteration_and_row_shape() -> None:
        db = create_in_memory_db()
        table = db["people"]
>       table.insert({"name": "Alice", "age": 30})

tests\Dataset\functional_test.py:255: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
repositories\Dataset\dataset\table.py:118: in insert
    row = self._sync_columns(row, ensure, types=types)
repositories\Dataset\dataset\table.py:366: in _sync_columns
    ensure = self._check_ensure(ensure)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = <[AttributeError("'Database' object has no attribute 'lock'") raised in repr()] Table object at 0x167c58f7160>
ensure = None

    def _check_ensure(self, ensure):
        if ensure is None:
>           return self.db.ensure_schema
E           AttributeError: 'Database' object has no attribute 'ensure_schema'

repositories\Dataset\dataset\table.py:386: AttributeError
_______________________ test_delete_and_clear_all_rows ________________________

    def test_delete_and_clear_all_rows() -> None:
        """
        Older dataset.Table may not expose truncate().
        Clear a table and end at 0 rows without relying on result iteration for DML.
        """
        db = create_in_memory_db()
        table = db["logs"]
>       table.insert_many([{"kind": "a"}, {"kind": "b"}, {"kind": "b"}])

tests\Dataset\functional_test.py:270: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
repositories\Dataset\dataset\table.py:172: in insert_many
    self._sync_columns(sync_row, ensure, types=types)
repositories\Dataset\dataset\table.py:366: in _sync_columns
    ensure = self._check_ensure(ensure)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = <[AttributeError("'Database' object has no attribute 'lock'") raised in repr()] Table object at 0x167c58d4670>
ensure = None

    def _check_ensure(self, ensure):
        if ensure is None:
>           return self.db.ensure_schema
E           AttributeError: 'Database' object has no attribute 'ensure_schema'

repositories\Dataset\dataset\table.py:386: AttributeError
___________________ test_drop_table_removes_from_db_tables ____________________

    def test_drop_table_removes_from_db_tables() -> None:
        db = create_in_memory_db()
        table = db["to_drop"]
>       table.insert({"x": 1})

tests\Dataset\functional_test.py:299: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
repositories\Dataset\dataset\table.py:118: in insert
    row = self._sync_columns(row, ensure, types=types)
repositories\Dataset\dataset\table.py:366: in _sync_columns
    ensure = self._check_ensure(ensure)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = <[AttributeError("'Database' object has no attribute 'lock'") raised in repr()] Table object at 0x167c47e81f0>
ensure = None

    def _check_ensure(self, ensure):
        if ensure is None:
>           return self.db.ensure_schema
E           AttributeError: 'Database' object has no attribute 'ensure_schema'

repositories\Dataset\dataset\table.py:386: AttributeError
_____________________ test_raw_sql_query_with_parameters ______________________

tmp_path = WindowsPath('C:/Users/86152/AppData/Local/Temp/pytest-of-86152/pytest-433/test_raw_sql_query_with_parame0')

    def test_raw_sql_query_with_parameters(tmp_path: Path) -> None:
        db_path = tmp_path / "param.db"
        db = dataset.connect("sqlite:///%s" % str(db_path))
        table = db["kv"]
>       table.insert_many([{"k": "a", "v": 1}, {"k": "b", "v": 2}])

tests\Dataset\functional_test.py:319: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
repositories\Dataset\dataset\table.py:172: in insert_many
    self._sync_columns(sync_row, ensure, types=types)
repositories\Dataset\dataset\table.py:366: in _sync_columns
    ensure = self._check_ensure(ensure)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = <[AttributeError("'Database' object has no attribute 'lock'") raised in repr()] Table object at 0x167c58eb6a0>
ensure = None

    def _check_ensure(self, ensure):
        if ensure is None:
>           return self.db.ensure_schema
E           AttributeError: 'Database' object has no attribute 'ensure_schema'

repositories\Dataset\dataset\table.py:386: AttributeError
_____________________ test_distinct_returns_unique_values _____________________

    def test_distinct_returns_unique_values() -> None:
        db = create_in_memory_db()
        table = db["colors"]
>       table.insert_many([{"c": "red"}, {"c": "red"}, {"c": "blue"}])

tests\Dataset\functional_test.py:330: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
repositories\Dataset\dataset\table.py:172: in insert_many
    self._sync_columns(sync_row, ensure, types=types)
repositories\Dataset\dataset\table.py:366: in _sync_columns
    ensure = self._check_ensure(ensure)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = <[AttributeError("'Database' object has no attribute 'lock'") raised in repr()] Table object at 0x167c477ff70>
ensure = None

    def _check_ensure(self, ensure):
        if ensure is None:
>           return self.db.ensure_schema
E           AttributeError: 'Database' object has no attribute 'ensure_schema'

repositories\Dataset\dataset\table.py:386: AttributeError
=========================== short test summary info ===========================
FAILED tests/Dataset/functional_test.py::test_insert_and_query_basic_rows - A...
FAILED tests/Dataset/functional_test.py::test_update_upsert_and_indexes - Att...
FAILED tests/Dataset/functional_test.py::test_transactions_commit_and_rollback
FAILED tests/Dataset/functional_test.py::test_insert_many_returns_ids_and_count
FAILED tests/Dataset/functional_test.py::test_find_one_missing_returns_none
FAILED tests/Dataset/functional_test.py::test_find_order_by_limit_offset - At...
FAILED tests/Dataset/functional_test.py::test_table_all_iteration_and_row_shape
FAILED tests/Dataset/functional_test.py::test_delete_and_clear_all_rows - Att...
FAILED tests/Dataset/functional_test.py::test_drop_table_removes_from_db_tables
FAILED tests/Dataset/functional_test.py::test_raw_sql_query_with_parameters
FAILED tests/Dataset/functional_test.py::test_distinct_returns_unique_values
11 failed in 5.07s
