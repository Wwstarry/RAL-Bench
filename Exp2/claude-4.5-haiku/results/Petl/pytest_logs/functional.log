.F.ss..sFsss                                                             [100%]
================================== FAILURES ===================================
_____________________ test_fromdicts_addfield_and_select ______________________

    def test_fromdicts_addfield_and_select() -> None:
        """Validate fromdicts, addfield, and select with a small in-memory table."""
        records = [
            {"id": 1, "value": 10},
            {"id": 2, "value": 20},
            {"id": 3, "value": 30},
            {"id": 4, "value": 40},
        ]
        table = petl.fromdicts(records, header=["id", "value"])
    
        table = petl.addfield(table, "double", lambda rec: int(rec["value"]) * 2)
        table = petl.select(table, lambda rec: int(rec["double"]) >= 60)
    
>       result = _table_to_list_of_dicts(table)

tests\Petl\functional_test.py:168: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\Petl\functional_test.py:87: in _table_to_list_of_dicts
    for row in iterator:
generation\Petl\petl\transform\selects.py:22: in __iter__
    if self.predicate(row):
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

rec = [1, 10, None]

>   table = petl.select(table, lambda rec: int(rec["double"]) >= 60)
E   TypeError: list indices must be integers or slices, not str

tests\Petl\functional_test.py:166: TypeError
___________________ test_tocsv_then_fromcsv_preserves_data ____________________

tmp_path = WindowsPath('C:/Users/86152/AppData/Local/Temp/pytest-of-86152/pytest-399/test_tocsv_then_fromcsv_preser0')

    def test_tocsv_then_fromcsv_preserves_data(tmp_path: Path) -> None:
        """Write a table to CSV and read it back, verifying header and row content."""
        src = tmp_path / "roundtrip.csv"
    
        table = petl.fromdicts(
            [{"a": 1, "b": "x"}, {"a": 2, "b": "y"}],
            header=["a", "b"],
        )
        petl.tocsv(table, str(src))
        assert src.exists()
    
        table2 = petl.fromcsv(str(src))
        rows = list(table2)
    
>       assert rows[0] == ("a", "b")
E       AssertionError: assert ['a', 'b'] == ('a', 'b')
E         
E         Use -v to get more diff

tests\Petl\functional_test.py:330: AssertionError
=========================== short test summary info ===========================
FAILED tests/Petl/functional_test.py::test_fromdicts_addfield_and_select - Ty...
FAILED tests/Petl/functional_test.py::test_tocsv_then_fromcsv_preserves_data
2 failed, 4 passed, 6 skipped in 0.62s
