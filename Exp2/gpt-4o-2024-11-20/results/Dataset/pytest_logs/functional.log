FFFFFFFFFFF                                                              [100%]
================================== FAILURES ===================================
______________________ test_insert_and_query_basic_rows _______________________

    def test_insert_and_query_basic_rows() -> None:
>       db = create_in_memory_db()

tests\Dataset\functional_test.py:139: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\Dataset\functional_test.py:106: in create_in_memory_db
    return dataset.connect("sqlite:///:memory:")
generation\Dataset\dataset\database.py:41: in connect
    return Database(url)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = <dataset.database.Database object at 0x000001E076BA0FD0>
url = 'sqlite:///:memory:'

    def __init__(self, url):
        if not url.startswith("sqlite://"):
            raise ValueError("Only SQLite databases are supported.")
>       self.connection = sqlite3.connect(url.split("://")[1], isolation_level=None)
E       sqlite3.OperationalError: unable to open database file

generation\Dataset\dataset\database.py:10: OperationalError
_______________________ test_update_upsert_and_indexes ________________________

    def test_update_upsert_and_indexes() -> None:
>       db = create_in_memory_db()

tests\Dataset\functional_test.py:168: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\Dataset\functional_test.py:106: in create_in_memory_db
    return dataset.connect("sqlite:///:memory:")
generation\Dataset\dataset\database.py:41: in connect
    return Database(url)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = <dataset.database.Database object at 0x000001E076BEFEE0>
url = 'sqlite:///:memory:'

    def __init__(self, url):
        if not url.startswith("sqlite://"):
            raise ValueError("Only SQLite databases are supported.")
>       self.connection = sqlite3.connect(url.split("://")[1], isolation_level=None)
E       sqlite3.OperationalError: unable to open database file

generation\Dataset\dataset\database.py:10: OperationalError
____________________ test_transactions_commit_and_rollback ____________________

tmp_path = WindowsPath('C:/Users/86152/AppData/Local/Temp/pytest-of-86152/pytest-265/test_transactions_commit_and_r0')

    def test_transactions_commit_and_rollback(tmp_path: Path) -> None:
        db_path = tmp_path / "tx_sample.db"
        db_url = "sqlite:///%s" % str(db_path)
        db = dataset.connect(db_url)
        table = db["events"]
    
        db.begin()
>       table.insert({"name": "committed", "category": "ok"})

tests\Dataset\functional_test.py:203: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = <dataset.table.Table object at 0x000001E075578EE0>
row = {'category': 'ok', 'name': 'committed'}

    def insert(self, row):
        keys = row.keys()
        columns = ", ".join(keys)
        placeholders = ", ".join(f":{key}" for key in keys)
>       self.connection.execute(f"INSERT INTO {self.name} ({columns}) VALUES ({placeholders})", row)
E       sqlite3.OperationalError: table events has no column named name

generation\Dataset\dataset\table.py:18: OperationalError
___________________ test_insert_many_returns_ids_and_count ____________________

    def test_insert_many_returns_ids_and_count() -> None:
>       db = create_in_memory_db()

tests\Dataset\functional_test.py:219: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\Dataset\functional_test.py:106: in create_in_memory_db
    return dataset.connect("sqlite:///:memory:")
generation\Dataset\dataset\database.py:41: in connect
    return Database(url)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = <dataset.database.Database object at 0x000001E076B867C0>
url = 'sqlite:///:memory:'

    def __init__(self, url):
        if not url.startswith("sqlite://"):
            raise ValueError("Only SQLite databases are supported.")
>       self.connection = sqlite3.connect(url.split("://")[1], isolation_level=None)
E       sqlite3.OperationalError: unable to open database file

generation\Dataset\dataset\database.py:10: OperationalError
_____________________ test_find_one_missing_returns_none ______________________

    def test_find_one_missing_returns_none() -> None:
>       db = create_in_memory_db()

tests\Dataset\functional_test.py:235: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\Dataset\functional_test.py:106: in create_in_memory_db
    return dataset.connect("sqlite:///:memory:")
generation\Dataset\dataset\database.py:41: in connect
    return Database(url)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = <dataset.database.Database object at 0x000001E076C2A340>
url = 'sqlite:///:memory:'

    def __init__(self, url):
        if not url.startswith("sqlite://"):
            raise ValueError("Only SQLite databases are supported.")
>       self.connection = sqlite3.connect(url.split("://")[1], isolation_level=None)
E       sqlite3.OperationalError: unable to open database file

generation\Dataset\dataset\database.py:10: OperationalError
_______________________ test_find_order_by_limit_offset _______________________

    def test_find_order_by_limit_offset() -> None:
>       db = create_in_memory_db()

tests\Dataset\functional_test.py:243: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\Dataset\functional_test.py:106: in create_in_memory_db
    return dataset.connect("sqlite:///:memory:")
generation\Dataset\dataset\database.py:41: in connect
    return Database(url)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = <dataset.database.Database object at 0x000001E076C06970>
url = 'sqlite:///:memory:'

    def __init__(self, url):
        if not url.startswith("sqlite://"):
            raise ValueError("Only SQLite databases are supported.")
>       self.connection = sqlite3.connect(url.split("://")[1], isolation_level=None)
E       sqlite3.OperationalError: unable to open database file

generation\Dataset\dataset\database.py:10: OperationalError
___________________ test_table_all_iteration_and_row_shape ____________________

    def test_table_all_iteration_and_row_shape() -> None:
>       db = create_in_memory_db()

tests\Dataset\functional_test.py:253: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\Dataset\functional_test.py:106: in create_in_memory_db
    return dataset.connect("sqlite:///:memory:")
generation\Dataset\dataset\database.py:41: in connect
    return Database(url)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = <dataset.database.Database object at 0x000001E076C09700>
url = 'sqlite:///:memory:'

    def __init__(self, url):
        if not url.startswith("sqlite://"):
            raise ValueError("Only SQLite databases are supported.")
>       self.connection = sqlite3.connect(url.split("://")[1], isolation_level=None)
E       sqlite3.OperationalError: unable to open database file

generation\Dataset\dataset\database.py:10: OperationalError
_______________________ test_delete_and_clear_all_rows ________________________

    def test_delete_and_clear_all_rows() -> None:
        """
        Older dataset.Table may not expose truncate().
        Clear a table and end at 0 rows without relying on result iteration for DML.
        """
>       db = create_in_memory_db()

tests\Dataset\functional_test.py:268: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\Dataset\functional_test.py:106: in create_in_memory_db
    return dataset.connect("sqlite:///:memory:")
generation\Dataset\dataset\database.py:41: in connect
    return Database(url)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = <dataset.database.Database object at 0x000001E076BE6A60>
url = 'sqlite:///:memory:'

    def __init__(self, url):
        if not url.startswith("sqlite://"):
            raise ValueError("Only SQLite databases are supported.")
>       self.connection = sqlite3.connect(url.split("://")[1], isolation_level=None)
E       sqlite3.OperationalError: unable to open database file

generation\Dataset\dataset\database.py:10: OperationalError
___________________ test_drop_table_removes_from_db_tables ____________________

    def test_drop_table_removes_from_db_tables() -> None:
>       db = create_in_memory_db()

tests\Dataset\functional_test.py:297: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\Dataset\functional_test.py:106: in create_in_memory_db
    return dataset.connect("sqlite:///:memory:")
generation\Dataset\dataset\database.py:41: in connect
    return Database(url)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = <dataset.database.Database object at 0x000001E076C23490>
url = 'sqlite:///:memory:'

    def __init__(self, url):
        if not url.startswith("sqlite://"):
            raise ValueError("Only SQLite databases are supported.")
>       self.connection = sqlite3.connect(url.split("://")[1], isolation_level=None)
E       sqlite3.OperationalError: unable to open database file

generation\Dataset\dataset\database.py:10: OperationalError
_____________________ test_raw_sql_query_with_parameters ______________________

tmp_path = WindowsPath('C:/Users/86152/AppData/Local/Temp/pytest-of-86152/pytest-265/test_raw_sql_query_with_parame0')

    def test_raw_sql_query_with_parameters(tmp_path: Path) -> None:
        db_path = tmp_path / "param.db"
        db = dataset.connect("sqlite:///%s" % str(db_path))
        table = db["kv"]
>       table.insert_many([{"k": "a", "v": 1}, {"k": "b", "v": 2}])

tests\Dataset\functional_test.py:319: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = <dataset.table.Table object at 0x000001E076BEF070>
rows = [{'k': 'a', 'v': 1}, {'k': 'b', 'v': 2}], chunk_size = None

    def insert_many(self, rows, chunk_size=None):
        if not rows:
            return
        keys = rows[0].keys()
        columns = ", ".join(keys)
        placeholders = ", ".join(f":{key}" for key in keys)
        query = f"INSERT INTO {self.name} ({columns}) VALUES ({placeholders})"
        if chunk_size:
            for i in range(0, len(rows), chunk_size):
                self.connection.executemany(query, rows[i:i+chunk_size])
        else:
>           self.connection.executemany(query, rows)
E           sqlite3.OperationalError: table kv has no column named k

generation\Dataset\dataset\table.py:31: OperationalError
_____________________ test_distinct_returns_unique_values _____________________

    def test_distinct_returns_unique_values() -> None:
>       db = create_in_memory_db()

tests\Dataset\functional_test.py:328: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\Dataset\functional_test.py:106: in create_in_memory_db
    return dataset.connect("sqlite:///:memory:")
generation\Dataset\dataset\database.py:41: in connect
    return Database(url)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = <dataset.database.Database object at 0x000001E076C27640>
url = 'sqlite:///:memory:'

    def __init__(self, url):
        if not url.startswith("sqlite://"):
            raise ValueError("Only SQLite databases are supported.")
>       self.connection = sqlite3.connect(url.split("://")[1], isolation_level=None)
E       sqlite3.OperationalError: unable to open database file

generation\Dataset\dataset\database.py:10: OperationalError
=========================== short test summary info ===========================
FAILED tests/Dataset/functional_test.py::test_insert_and_query_basic_rows - s...
FAILED tests/Dataset/functional_test.py::test_update_upsert_and_indexes - sql...
FAILED tests/Dataset/functional_test.py::test_transactions_commit_and_rollback
FAILED tests/Dataset/functional_test.py::test_insert_many_returns_ids_and_count
FAILED tests/Dataset/functional_test.py::test_find_one_missing_returns_none
FAILED tests/Dataset/functional_test.py::test_find_order_by_limit_offset - sq...
FAILED tests/Dataset/functional_test.py::test_table_all_iteration_and_row_shape
FAILED tests/Dataset/functional_test.py::test_delete_and_clear_all_rows - sql...
FAILED tests/Dataset/functional_test.py::test_drop_table_removes_from_db_tables
FAILED tests/Dataset/functional_test.py::test_raw_sql_query_with_parameters
FAILED tests/Dataset/functional_test.py::test_distinct_returns_unique_values
11 failed in 3.16s
