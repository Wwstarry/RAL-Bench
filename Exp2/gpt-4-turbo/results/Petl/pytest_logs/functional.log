.FFss.Fs.sss                                                             [100%]
================================== FAILURES ===================================
_____________________ test_fromdicts_addfield_and_select ______________________

    def test_fromdicts_addfield_and_select() -> None:
        """Validate fromdicts, addfield, and select with a small in-memory table."""
        records = [
            {"id": 1, "value": 10},
            {"id": 2, "value": 20},
            {"id": 3, "value": 30},
            {"id": 4, "value": 40},
        ]
        table = petl.fromdicts(records, header=["id", "value"])
    
        table = petl.addfield(table, "double", lambda rec: int(rec["value"]) * 2)
        table = petl.select(table, lambda rec: int(rec["double"]) >= 60)
    
>       result = _table_to_list_of_dicts(table)

tests\Petl\functional_test.py:168: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\Petl\functional_test.py:87: in _table_to_list_of_dicts
    for row in iterator:
generation\Petl\petl\transform\selects.py:10: in __iter__
    for row in it:
generation\Petl\petl\transform\conversions.py:64: in __iter__
    new_value = self.func(row)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

rec = (1, 10)

>   table = petl.addfield(table, "double", lambda rec: int(rec["value"]) * 2)
E   TypeError: tuple indices must be integers or slices, not str

tests\Petl\functional_test.py:165: TypeError
_______________________ test_join_two_tables_fromdicts ________________________

    def test_join_two_tables_fromdicts() -> None:
        """Check that an inner join between two small tables behaves as expected."""
        customers = [
            {"id": 1, "name": "Alice"},
            {"id": 2, "name": "Bob"},
            {"id": 3, "name": "Carol"},
        ]
        orders = [
            {"id": 1, "amount": 100},
            {"id": 1, "amount": 50},
            {"id": 2, "amount": 200},
        ]
    
        customers_tbl = petl.fromdicts(customers, header=["id", "name"])
        orders_tbl = petl.fromdicts(orders, header=["id", "amount"])
    
        joined = petl.join(customers_tbl, orders_tbl, key="id")
        result = _table_to_list_of_dicts(joined)
    
>       assert len(result) == 3
E       AssertionError: assert 2 == 3
E        +  where 2 = len([{'amount': 50, 'id': 1, 'name': 'Alice'}, {'amount': 200, 'id': 2, 'name': 'Bob'}])

tests\Petl\functional_test.py:195: AssertionError
_____________________ test_sort_descending_orders_values ______________________

    def test_sort_descending_orders_values() -> None:
        """Sort descending by a numeric field."""
        _require_attr("sort")
    
        records = [
            {"name": "A", "score": 10},
            {"name": "B", "score": 30},
            {"name": "C", "score": 20},
        ]
        table = petl.fromdicts(records, header=["name", "score"])
    
        # petl.sort supports reverse=True in typical implementations.
>       sorted_tbl = petl.sort(table, "score", reverse=True)
E       TypeError: sort() got an unexpected keyword argument 'reverse'

tests\Petl\functional_test.py:278: TypeError
=========================== short test summary info ===========================
FAILED tests/Petl/functional_test.py::test_fromdicts_addfield_and_select - Ty...
FAILED tests/Petl/functional_test.py::test_join_two_tables_fromdicts - Assert...
FAILED tests/Petl/functional_test.py::test_sort_descending_orders_values - Ty...
3 failed, 3 passed, 6 skipped in 0.50s
