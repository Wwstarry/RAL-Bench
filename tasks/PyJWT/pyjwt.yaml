task_id: pyjwt
domain: security
difficulty: medium
description: "Implement a pure Python JSON Web Token (JWT) library that is API-compatible\n\
  with the core parts of the reference PyJWT project. The generated repository must:\n\
  \n- Provide the package structure required by the test suite, including:\n    *\
  \ jwt\n    * jwt.api_jwt\n    * jwt.exceptions\n\n- Expose the high-level APIs used\
  \ by the tests on the top-level jwt package:\n    * jwt.encode(payload, key, algorithm=\"\
  HS256\", **kwargs)\n    * jwt.decode(token, key, algorithms=[\"HS256\"], options=None,\
  \ leeway=0, **kwargs)\n\n- Implement HS256-based signing and verification so that:\n\
  \    * encode() produces a compact JWT string with header, payload and signature.\n\
  \    * decode() verifies the HMAC signature when a key and algorithms=[\"HS256\"\
  ] are provided.\n    * decoding with a wrong key raises jwt.InvalidSignatureError.\n\
  \    * decoding without specifying algorithms when verification is expected raises\
  \ jwt.DecodeError.\n\n- Provide the standard exception types re-exported from jwt.exceptions\
  \ and used by the tests,\n  including at least:\n    * jwt.ExpiredSignatureError\n\
  \    * jwt.InvalidSignatureError\n    * jwt.DecodeError\n\n- Support the \"exp\"\
  \ (expiration) claim and verification options as exercised in the tests:\n    *\
  \ tokens with an expired \"exp\" must raise jwt.ExpiredSignatureError when verify_exp=True.\n\
  \    * the \"leeway\" parameter must allow slightly expired tokens to still be accepted.\n\
  \n- Behave in a way that allows all black-box tests under ./tests/PyJWT/ to run\n\
  \  successfully on the generated implementation using HS256 without requiring\n\
  \  external cryptography libraries.\n"
interfaces:
  type: LIB
  language: python
  entry_point: jwt/__init__.py
reference_repository: ./repositories/PyJWT
baseline_metrics:
  performance:
    performance_suite_time_s: 1.272328
    performance_tests_total: 1
  resource:
    resource_suite_time_s: 1.374763
    resource_tests_total: 3
    avg_memory_mb: 32.45
    avg_cpu_percent: 97.5
  functional:
    functional_suite_time_s: 1.285872
    functional_tests_total: 11
  robustness:
    robustness_suite_time_s: 1.543038
    robustness_tests_total: 4
  security:
    security_suite_time_s: 1.347434
    security_tests_total: 1
    metrics:
      high_risk_count: 0.0
      files_scanned: 12.0
      total_loc: 2146.0
  maintainability:
    maintainability_suite_time_s: 1.290264
    maintainability_tests_total: 1
    metrics:
      mi_min: 4.6208
      files_scanned: 12.0
      total_loc: 2146.0
      max_cc: 19.0
test_suite:
  functional: ./tests/PyJWT/functional_test.py
  performance: ./tests/PyJWT/performance_test.py
  resource: ./tests/PyJWT/resource_test.py
  robustness: ./tests/PyJWT/robustness_test.py
  security: ./tests/_generic/security_test.py
  maintainability: ./tests/_generic/maintainability_test.py
generated_repository: ./generation/PyJWT
package:
  name: jwt
  root_dir: .
files:
- path: jwt/__init__.py
  role: package_init
  description: Top-level jwt package exposing encode, decode and exception aliases.
- path: jwt/api_jwt.py
  role: jwt_api
  description: Core implementation of encode() and decode() logic.
- path: jwt/exceptions.py
  role: jwt_exceptions
  description: Defines JWT-related exception classes used by the tests.
