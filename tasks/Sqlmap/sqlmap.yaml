task_id: sqlmap
domain: security
difficulty: medium
description: 'Implement a pure Python CLI-driven SQL injection testing tool that is
  interface-compatible with the core entrypoint and module layout of the reference
  sqlmap project under ./repositories/sqlmap. The generated repository must:


  - Provide a runnable CLI entrypoint at repo root: "sqlmap.py", executable via `python
  sqlmap.py ...`.


  - Preserve the key internal/public API surface used by the test suite, including
  at least:

  * Command-line parsing:

  - lib.parse.cmdline.cmdLineParser


  * Options initialization:

  - lib.core.option.init

  - lib.core.option.initOptions


  * Core shared runtime state referenced by the CLI entrypoint:

  - lib.core.data: cmdLineOptions, conf, kb


  * Core settings/metadata constants:

  - lib.core.settings: VERSION, DESCRIPTION (or equivalent string metadata)


  * Controller entry point:

  - lib.controller.controller.start


  - Support benign CLI invocations used by tests without requiring any external target:

  - `python sqlmap.py -h` (basic help)

  - `python sqlmap.py -hh` (advanced help)

  - `python sqlmap.py --version` (version output)


  - Handle invalid or nonsensical arguments robustly (exit cleanly, no crash/hang),
  and produce an informative error/help message.


  - Behave so the same black-box tests run successfully on the generated repo, including
  exact module paths, symbol names, and observable CLI behaviour.

  '
reference_repository: ./repositories/sqlmap
generated_repository: ./generation/Sqlmap
package:
  name: lib
  root_dir: .
test_suite:
  functional: ./tests/Sqlmap/functional_test.py
  performance: ./tests/Sqlmap/performance_test.py
  resource: ./tests/Sqlmap/resource_test.py
  robustness: ./tests/Sqlmap/robustness_test.py
  security: ./tests/_generic/security_test.py
  maintainability: ./tests/_generic/maintainability_test.py
suite_timeouts_s:
  default: 120
  functional: 120
  performance: 120
  resource: 120
  robustness: 120
  security: 300
  maintainability: 300
weights:
  functional: 0.4
  performance: 0.15
  resource: 0.1
  robustness: 0.15
  security: 0.1
  maintainability: 0.1
interfaces:
  entry_point: sqlmap.py
  language: python
  type: CLI
baseline_metrics:
  functional:
    functional_suite_time_s: 8.046427
    functional_tests_total: 9
  performance:
    performance_suite_time_s: 2.141399
    performance_tests_total: 1
  resource:
    resource_suite_time_s: 2.106958
    resource_tests_total: 1
    avg_memory_mb: 33.23
    avg_cpu_percent: 51.2
  robustness:
    robustness_suite_time_s: 6.540569
    robustness_tests_total: 5
  security:
    security_suite_time_s: 1.891213
    security_tests_total: 1
    metrics:
      high_risk_count: 11.0
      files_scanned: 102.0
      total_loc: 27632.0
  maintainability:
    maintainability_suite_time_s: 3.958007
    maintainability_tests_total: 1
    metrics:
      mi_min: 0.0
      files_scanned: 102.0
      total_loc: 27632.0
      max_cc: 313.0
