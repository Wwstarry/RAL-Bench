#!/usr/bin/env python3
"""Fail2Ban client command-line interface."""

import sys
import argparse
from fail2ban.client.client import Client


def main():
    """Main entry point for fail2ban-client."""
    parser = argparse.ArgumentParser(
        description='Fail2Ban client - communicate with Fail2Ban server',
        prog='fail2ban-client',
    )
    
    parser.add_argument(
        '--version',
        action='version',
        version='%(prog)s 0.11.0',
    )
    
    parser.add_argument(
        '--help',
        action='help',
        help='show this help message and exit',
    )
    
    parser.add_argument(
        'command',
        nargs='?',
        help='Command to execute (status, get, set, etc.)',
    )
    
    parser.add_argument(
        'args',
        nargs='*',
        help='Arguments for the command',
    )
    
    args = parser.parse_args()
    
    if not args.command:
        parser.print_help()
        return 0
    
    client = Client()
    
    try:
        if args.command == 'status':
            status = client.getStatus()
            print(f"Fail2Ban version: {status['version']}")
            print(f"Jails: {len(status['jails'])}")
            return 0
        else:
            print(f"Unknown command: {args.command}", file=sys.stderr)
            return 1
    except Exception as e:
        print(f"Error: {e}", file=sys.stderr)
        return 1


if __name__ == '__main__':
    sys.exit(main())