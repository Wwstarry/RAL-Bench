# Fail2Ban filter for sshd
#
# This is a simplified filter configuration for SSH failures

[Definition]
failregex = ^%(__prefix_line)s(?:error: PAM: )?[aA]uthentication (?:failure|error) for .* from <HOST>( via \S+)?\s*$
            ^%(__prefix_line)s[iI](?:llegal|nvalid) user .* from <HOST>\s*$
            ^%(__prefix_line)s[uU]ser .* from <HOST> not allowed because not listed in AllowUsers\s*$
            ^%(__prefix_line)sFailed \S+ for .* from <HOST>(?: port \d*)?(?: ssh\d*)?(: \S+)?\s*$

ignoreregex =

# Default settings
[Init]
__prefix_line = \S+ \S+ sshd\[\d+\]: