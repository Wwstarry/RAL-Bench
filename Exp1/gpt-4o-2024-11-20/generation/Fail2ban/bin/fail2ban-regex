#!/usr/bin/env python3
import argparse
import re

def test_regex(logfile, pattern):
    """
    Test a regex pattern against a log file.
    """
    with open(logfile, "r") as f:
        for line in f:
            if re.search(pattern, line):
                print(f"Matched: {line.strip()}")

def main():
    parser = argparse.ArgumentParser(description="Fail2Ban Regex Tester")
    parser.add_argument("logfile", help="Path to the log file")
    parser.add_argument("pattern", help="Regex pattern to test")
    parser.add_argument("--help", action="help", help="Show this help message and exit")
    args = parser.parse_args()

    test_regex(args.logfile, args.pattern)

if __name__ == "__main__":
    main()