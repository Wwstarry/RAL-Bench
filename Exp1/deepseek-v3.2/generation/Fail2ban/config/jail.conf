# Fail2Ban configuration file
#
# This is a minimal configuration for safe offline testing.
# DO NOT use this in production without proper review.

[DEFAULT]
# "bantime" is the number of seconds that a host is banned.
bantime  = 600

# A host is banned if it has generated "maxretry" during the last "findtime"
# seconds.
findtime  = 600

# "maxretry" is the number of failures before a host get banned.
maxretry = 5

# "backend" specifies how log files are monitored.
# This is simplified for testing.
backend = auto

# "enabled" enables the jails.
enabled = true

# "logpath" target log file for the jail.
# This would be set per-jail in real usage.

[sshd]
# SSH jail configuration
enabled = true
port    = ssh
logpath = /var/log/auth.log
maxretry = 3
bantime  = 3600

# Filter for SSH failures
filter = sshd
failregex = ^%(__prefix_line)s(?:error: PAM: )?[aA]uthentication (?:failure|error) for .* from <HOST>(?: port \d+)?\s*$
            ^%(__prefix_line)s(?:error: PAM: )?User not known to the underlying authentication module for .* from <HOST>\s*$
            ^%(__prefix_line)sFailed password for .* from <HOST> port \d+ ssh2\s*$

[apache-auth]
# Apache authentication failures
enabled = false
port    = http,https
logpath = /var/log/apache*/*error.log
maxretry = 3

# Filter for Apache auth failures
filter = apache-auth
failregex = ^%(__prefix_line)sclient <HOST>.* authentication failure.*$

[test-jail]
# Test jail for safe offline testing
enabled = true
port    = 22
logpath = test.log
maxretry = 2
findtime = 300
bantime  = 300

# Simple test filter
filter = test
failregex = FAILED login from <HOST>
            Authentication failed for .* from <HOST>